<html>
<head>
<style type="text/css">



</style>
</head>
</html>{% extends "base.html" %}
{% block title %}
 Fill the form
{% endblock %}
{% block content %}
<title> Give Your Feedback..!!</title>
<script language='javascript'>

function mandatory()
{
   
   {% for id,type in mandatoryQuestions.items %}
    flag=1
    alert("next mandatory... {{ type }}")
    {% if type == 'multiple-choice-single-answer' %}
        var radio= document.forms.feedbackForm.q{{id}}_rdb_opt;
        alert("found radio..!!"+radio.id);
        for(i=0;i<radio.length;i++)
          {          
              if (radio[i].checked) 
                 {
                    flag=4;
                    alert("found checked..."+radio[i].value)
                 }  
          }
        alert("flag = " + flag)  
        if(flag!=4) 
        {   
            alert('Please answer the mandatory radio button questions');
            radio[0].focus();
            return false;
        }
    {% endif %}  
    {% comment %}{% if type == 'multiple-choice-multiple-answer' %}
       var check=document.forms.feedbackForm.
       for(i=0;i<check.length;i++)
           {
             //alert(check[i].value);
             if(check[i].checked) 
               {
                  flag=7;
               }
               
           }
       if(flag!=7) 
       {
           alert('Please answer the mandatory checkbox questions!');
           check[0].focus();
           return false;
       }

    {% endif %}  {% endcomment %}   
    {%if type == 'text'%}
         var a='q{{id}}'
         var text=document.getElementById(a);
         if(text.value=="")
         {
             alert('Please answer the mandatory text question!');
             text.focus();
             return false;
         }
         else flag=5;
    {% endif %}      
   {% endfor %} 
 if(flag!=1) return true;
 else return false;
}

function debug(str)
{
    alert(str);
}


</script>
<h3 align='left'> Hiya {{ username }} </h3>
<h4 align='left'> Your feedback is valuable to us! </h4>
<h2 align= 'center'><formTitle>{{ form.title }}</formTitle></h2>

<div id="form">
{% if flag == 'show' %}
  <form name='feedbackForm' action='/give_feedback/{{ form.id }}/submit/' method='POST' onsubmit='return mandatory();'>
{% else %}  
  <form name='feedbackForm' action='/give_feedback/{{ form.id }}/edit/' method='POST' onsubmit='return mandatory();'>
  <input type='hidden' name='submissionID' value='{{ submissionID }}'>
{% endif %}
<ol>
    {% csrf_token %}
    {% for q in form.questions.all %}
    
    <li><q>{{ q.text }}</q>
        {% if q.mandatory %}
            <sup>*</sup>
         {% endif %}
    <br>
		{% if q.type == 'multiple-choice-single-answer' %}
			{% for opt in q.feedbackquestionoption_set.values %}
            <input type='radio' id = 'q{{q.id}}' name='q{{ q.id }}_rdb_opt' value='{{ opt.id }}'/>
	             <label for='q{{ q.id }}_rdb_opt'>
        	           <ans>{{ opt.text }}</ans>
		         </label> <br/>
		    {% endfor %}
		{% endif %}
		{% if q.type == 'multiple-choice-multiple-answer' %}
            {% for opt in q.feedbackquestionoption_set.values %}
            <input type='checkbox' id = 'q{{q.id}}' name='q{{ q.id }}_chk_opt{{ opt.id }}'/> 
	             <label for='q{{ q.id }}_chk_opt{{ opt.id }}'>
        	            <ans>{{ opt.text }}</ans>
                 </label><br/>
        	{% endfor %}
		{% endif %}
		{% if q.type == 'text' %}
			<textarea id='q{{q.id}}'name='q{{ q.id }}_txt' rows='8' cols='120'></textarea> <br/>
		{% endif %}
	    <br/>
   {% endfor %}
          <input type='hidden' name='formid' value='{{ form.id }}'> 
     	<input type='submit' value='Submit feedback!'>
	<input type='button' onclick="javascript:location.href='/give_feedback/'" value='Cancel'>
</form>
</div>
{% endblock %}
